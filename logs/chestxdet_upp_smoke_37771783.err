
=====================================================================
This module is only for creating or activating Python environments:
$ mamba create -n myenv -c conda-forge python=3 <package_name>
$ source activate myenv

Only run "pip install" after activating an environment.
Running pip without activating an environment is known to cause issues.

To list available environments:
$ mamba info --envs

Other uses are not tested. More info: https://links.asu.edu/solpy
=====================================================================

  
ERROR: Could not find a version that satisfies the requirement pytorch==0.4.1 (from versions: 0.1.2, 1.0.2)
ERROR: No matching distribution found for pytorch==0.4.1
/scratch/smehta90/upernet_chestxdet/semantic-segmentation-pytorch/train.py:293: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
  assert LooseVersion(torch.__version__) >= LooseVersion('0.4.0'), \
Traceback (most recent call last):
  File "/scratch/smehta90/upernet_chestxdet/semantic-segmentation-pytorch/train.py", line 357, in <module>
    main(cfg, gpus)
  File "/scratch/smehta90/upernet_chestxdet/semantic-segmentation-pytorch/train.py", line 287, in main
    validate(segmentation_module, cfg, epoch+1)
  File "/home/smehta90/.conda/envs/upernet_env/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/smehta90/upernet_chestxdet/semantic-segmentation-pytorch/train.py", line 150, in validate
    metrics = dice_iou_from_logits(pred, sample['seg_label'], cfg.DATASET.num_class)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/smehta90/.conda/envs/upernet_env/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/smehta90/upernet_chestxdet/semantic-segmentation-pytorch/mit_semseg/metrics/dice_iou.py", line 14, in dice_iou_from_logits
    pred, lab = _flat_preds_labels(logits, labels, num_class, ignore_index)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/smehta90/upernet_chestxdet/semantic-segmentation-pytorch/mit_semseg/metrics/dice_iou.py", line 8, in _flat_preds_labels
    pred = pred[mask]
           ~~~~^^^^^^
IndexError: The shape of the mask [1, 1024, 1024] at index 1 does not match the shape of the indexed tensor [1, 80, 80] at index 1
